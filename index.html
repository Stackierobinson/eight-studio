<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="8 - Contemporary Digital Artist Portfolio and Interactive Studio">
    <title>8 | Digital Sanctuary</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #e0e0e0;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            overflow-x: hidden;
            transition: all 1s ease;
        }

        /* Gallery Styles */
        .gallery-mode {
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        .studio-mode {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0d0d0d 0%, #1a0a0a 50%, #0a0a0a 100%);
        }

        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 20px 40px;
            transition: all 0.5s ease;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 900;
            color: #fff;
            letter-spacing: -0.05em;
            transition: all 0.5s ease;
        }

        .studio-mode .logo {
            color: #ff6b6b;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        .nav-links {
            display: flex;
            gap: 40px;
            list-style: none;
        }

        .nav-links a {
            color: #e0e0e0;
            text-decoration: none;
            font-weight: 300;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: #fff;
            transform: translateY(-2px);
        }

        .nav-links a.studio-link {
            color: #ff6b6b;
            font-style: italic;
        }

        .nav-links a.studio-link:hover {
            color: #ff5252;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        /* Gallery Container */
        .gallery-container {
            transition: all 1s ease;
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: linear-gradient(45deg, #0a0a0a, #1a1a1a, #0a0a0a);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .hero-content {
            text-align: center;
            z-index: 2;
        }

        .hero-number {
            font-size: 15rem;
            font-weight: 900;
            color: #fff;
            text-shadow: 0 0 50px rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .hero-subtitle {
            font-size: 1.8rem;
            font-weight: 300;
            color: #a0a0a0;
            margin-bottom: 40px;
            letter-spacing: 0.1em;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }

        .section {
            min-height: 100vh;
            display: none;
            padding: 100px 0;
        }

        .section.active {
            display: block;
        }

        .section h2 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 60px;
            text-align: center;
            color: #fff;
        }

        /* Gallery Grid */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .gallery-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.4s ease;
            cursor: pointer;
        }

        .gallery-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.08);
        }

        .gallery-img {
            width: 100%;
            height: 300px;
            background: linear-gradient(45deg, #333, #555);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 1.2rem;
        }

        .gallery-info {
            padding: 25px;
        }

        .gallery-info h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .gallery-info p {
            color: #a0a0a0;
            line-height: 1.6;
        }

        /* About Section */
        .about-content {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.2rem;
            line-height: 2;
            color: #c0c0c0;
        }

        .about-content p {
            margin-bottom: 30px;
        }

        /* Contact Section */
        .contact-content {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .contact-item {
            margin: 40px 0;
            font-size: 1.3rem;
        }

        .contact-item a {
            color: #fff;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .contact-item a:hover {
            color: #ff6b6b;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        /* Studio Portal */
        .studio-portal {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.3);
        }

        .studio-portal:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.5);
        }

        .studio-portal::before {
            content: "↓";
            font-size: 2rem;
            color: white;
            font-weight: bold;
        }

        /* STUDIO INTERFACE */
        .studio-interface {
            display: none;
            height: 100vh;
            flex-direction: column;
        }

        .studio-interface.active {
            display: flex;
        }

        /* Ambient background effects */
        .ambient-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .studio-mode .ambient-layer {
            opacity: 1;
        }

        .ambient-layer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 107, 107, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(107, 255, 107, 0.02) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(107, 107, 255, 0.02) 0%, transparent 50%);
            animation: ambientShift 20s ease infinite alternate;
        }

        @keyframes ambientShift {
            0% { transform: rotate(0deg) scale(1); }
            100% { transform: rotate(5deg) scale(1.1); }
        }

        /* Studio Header */
        .studio-header {
            position: relative;
            z-index: 10;
            padding: 20px 30px;
            border-bottom: 1px solid rgba(255, 107, 107, 0.2);
            background: rgba(13, 13, 13, 0.9);
            backdrop-filter: blur(10px);
        }

        .studio-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .studio-logo {
            font-size: 1.8rem;
            font-weight: 900;
            color: #ff6b6b;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        .back-to-gallery {
            color: #666;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 1px solid #333;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        .back-to-gallery:hover {
            color: #999;
            border-color: #555;
        }

        /* Main Studio Layout */
        .studio-container {
            display: flex;
            height: calc(100vh - 160px);
            position: relative;
            z-index: 5;
        }

        /* Left Wall - Gallery */
        .studio-wall {
            width: 300px;
            background: rgba(10, 10, 10, 0.8);
            border-right: 1px solid rgba(255, 107, 107, 0.1);
            padding: 20px;
            overflow-y: auto;
        }

        .wall-title {
            font-size: 1.1rem;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .wall-piece {
            background: rgba(255, 255, 255, 0.03);
            margin-bottom: 15px;
            border-radius: 4px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .wall-piece:hover {
            background: rgba(255, 107, 107, 0.05);
            transform: translateX(5px);
        }

        .wall-piece-img {
            height: 120px;
            background: linear-gradient(45deg, #222, #333);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #666;
        }

        .wall-piece-title {
            padding: 10px;
            font-size: 0.9rem;
            color: #ccc;
        }

        /* Center Area - Chat */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(5, 5, 5, 0.8);
        }

        .artist-presence {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 107, 107, 0.1);
            background: rgba(13, 13, 13, 0.8);
            text-align: center;
        }

        .artist-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            animation: pulse 3s ease-in-out infinite;
        }

        .artist-status {
            font-size: 0.9rem;
            color: #66ff66;
            margin-bottom: 5px;
        }

        .artist-mood {
            font-size: 0.8rem;
            color: #999;
            font-style: italic;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            max-height: 400px;
        }

        .message {
            margin-bottom: 20px;
            animation: messageSlide 0.5s ease;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.artist {
            text-align: right;
        }

        .message-content {
            display: inline-block;
            max-width: 70%;
            padding: 12px 18px;
            border-radius: 18px;
            font-size: 0.95rem;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .message.visitor .message-content {
            background: rgba(255, 255, 255, 0.05);
            color: #e0e0e0;
        }

        .message.artist .message-content {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .message-time {
            font-size: 0.7rem;
            color: #666;
            margin-top: 5px;
        }

        /* Error message styles */
        .error-message {
            background: rgba(255, 100, 100, 0.1);
            border: 1px solid rgba(255, 100, 100, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            color: #ff6b6b;
            font-size: 0.9rem;
            animation: fadeInOut 5s ease forwards;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* Rate limit warning */
        .rate-limit-warning {
            background: rgba(255, 165, 0, 0.1);
            border: 1px solid rgba(255, 165, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            color: #ffa500;
            font-size: 0.9rem;
        }

        /* Typing Indicator */
        .typing-indicator .message-content {
            padding: 8px 18px;
        }

        .typing-dots {
            display: inline-block;
        }

        .typing-dots span {
            opacity: 0.4;
            animation: typingDots 1.4s infinite;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDots {
            0%, 60%, 100% { opacity: 0.4; }
            30% { opacity: 1; }
        }

        .chat-input-area {
            padding: 20px;
            border-top: 1px solid rgba(255, 107, 107, 0.1);
            background: rgba(13, 13, 13, 0.9);
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            border-radius: 20px;
            padding: 12px 18px;
            color: #e0e0e0;
            font-family: inherit;
            font-size: 0.95rem;
            resize: none;
            min-height: 40px;
            max-height: 120px;
        }

        .chat-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.1);
        }

        .chat-input.error {
            border-color: #ff4444;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.2);
        }

        .send-button {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-button:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Right Panel - Studio Info */
        .studio-info {
            width: 250px;
            background: rgba(10, 10, 10, 0.8);
            border-left: 1px solid rgba(255, 107, 107, 0.1);
            padding: 20px;
            overflow-y: auto;
        }

        .info-section {
            margin-bottom: 30px;
        }

        .info-title {
            font-size: 0.9rem;
            color: #ff6b6b;
            margin-bottom: 10px;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .current-track {
            font-size: 0.8rem;
            color: #999;
            margin-bottom: 5px;
        }

        .track-title {
            color: #ccc;
            font-style: italic;
        }

        .studio-stats {
            font-size: 0.8rem;
            color: #666;
        }

        .studio-stats div {
            margin-bottom: 5px;
        }

        /* Online Status Indicator */
        .online-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #66ff66;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 2s infinite;
        }

        /* Ambient Audio Controls */
        .audio-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(13, 13, 13, 0.9);
            padding: 10px 15px;
            border-radius: 25px;
            border: 1px solid rgba(255, 107, 107, 0.2);
            backdrop-filter: blur(10px);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .studio-mode .audio-controls {
            opacity: 1;
        }

        .audio-toggle {
            background: none;
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            font-size: 1.2rem;
        }

        /* Transition Effects */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, #ff6b6b 0%, #000 100%);
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease;
        }

        .page-transition.active {
            opacity: 1;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-number {
                font-size: 8rem;
            }
            
            .nav-links {
                gap: 20px;
            }
            
            .gallery-grid {
                grid-template-columns: 1fr;
            }
            
            .section h2 {
                font-size: 2rem;
            }

            .studio-wall, .studio-info {
                display: none;
            }
            
            .chat-area {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="ambient-layer"></div>
    <div class="page-transition" id="pageTransition"></div>

    <!-- GALLERY INTERFACE -->
    <div class="gallery-container" id="galleryContainer">
        <nav class="nav">
            <div class="nav-container">
                <div class="logo">8</div>
                <ul class="nav-links">
                    <li><a href="#home" class="nav-link active">Home</a></li>
                    <li><a href="#gallery" class="nav-link">Gallery</a></li>
                    <li><a href="#about" class="nav-link">About</a></li>
                    <li><a href="#contact" class="nav-link">Contact</a></li>
                    <li><a href="#studio" class="nav-link studio-link">Enter the Studio</a></li>
                </ul>
            </div>
        </nav>

        <section id="home" class="hero">
            <div class="hero-content">
                <div class="hero-number">8</div>
                <div class="hero-subtitle">CONTEMPORARY VISIONS</div>
            </div>
        </section>

        <div class="main-content">
            <section id="gallery" class="section">
                <h2>Gallery</h2>
                <div class="gallery-grid">
                    <div class="gallery-item" onclick="viewArtwork('Urban Fragments')">
                        <div class="gallery-img" role="img" aria-label="Urban Fragments artwork preview">Urban Fragments #1</div>
                        <div class="gallery-info">
                            <h3>Urban Fragments</h3>
                            <p>Mixed media exploration of city decay and renewal. Raw materials meet digital intervention in this ongoing series.</p>
                        </div>
                    </div>
                    <div class="gallery-item" onclick="viewArtwork('Neon Dreams')">
                        <div class="gallery-img" role="img" aria-label="Neon Dreams artwork preview">Neon Dreams #2</div>
                        <div class="gallery-info">
                            <h3>Neon Dreams</h3>
                            <p>Synthetic landscapes born from late-night studio sessions. Where digital meets analog in explosive color.</p>
                        </div>
                    </div>
                    <div class="gallery-item" onclick="viewArtwork('Shadow Work')">
                        <div class="gallery-img" role="img" aria-label="Shadow Work artwork preview">Shadow Work #3</div>
                        <div class="gallery-info">
                            <h3>Shadow Work</h3>
                            <p>Intimate portraits of spaces between consciousness. Each piece reveals what hides in peripheral vision.</p>
                        </div>
                    </div>
                    <div class="gallery-item" onclick="viewArtwork('Digital Flesh')">
                        <div class="gallery-img" role="img" aria-label="Digital Flesh artwork preview">Digital Flesh #4</div>
                        <div class="gallery-info">
                            <h3>Digital Flesh</h3>
                            <p>The human form reimagined through technological lens. Beauty found in the intersection of organic and synthetic.</p>
                        </div>
                    </div>
                    <div class="gallery-item" onclick="viewArtwork('Midnight Studies')">
                        <div class="gallery-img" role="img" aria-label="Midnight Studies artwork preview">Midnight Studies #5</div>
                        <div class="gallery-info">
                            <h3>Midnight Studies</h3>
                            <p>Raw sketches elevated to gallery status. The creative process laid bare in graphite and digital intervention.</p>
                        </div>
                    </div>
                    <div class="gallery-item" onclick="viewArtwork('Abstract Futures')">
                        <div class="gallery-img" role="img" aria-label="Abstract Futures artwork preview">Abstract Futures #6</div>
                        <div class="gallery-info">
                            <h3>Abstract Futures</h3>
                            <p>What tomorrow might look like filtered through today's anxieties. Hope and fear in equal measure.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="about" class="section">
                <h2>About 8</h2>
                <div class="about-content">
                    <p>I don't paint pretty pictures. I paint the spaces where society refuses to look.</p>
                    
                    <p>Born into a system that had no words for what I was becoming, I learned early that survival meant creating your own light in absolute darkness. Foster care taught me that home isn't a place - it's something you build from whatever materials refuse to break you.</p>
                    
                    <p>My work exists in the liminal spaces - between masculine and feminine, between classical technique and street urgency, between the pain that destroys and the pain that transforms. I use Caravaggio's chiaroscuro not to illuminate saints, but to reveal the sacred in the discarded.</p>
                    
                    <p>The number 8 chose me during a psychotic break at seventeen. Infinity turned vertical. Endless possibility refusing to lie down.</p>
                    
                    <p>My studio is a converted subway maintenance tunnel where I work between 2 and 6 AM, when the city stops performing and shows its true face. I embed LED strips in wet oil paint. I mix ash from burned love letters into custom pigments. I shatter mirrors so viewers become part of the composition whether they want to or not.</p>
                    
                    <p>Each piece I release has survived my own attempts to destroy it. If it's for sale, it's because it taught me something about being human that I didn't know before I painted it.</p>
                    
                    <p style="margin-top: 40px; font-style: italic; color: #ff6b6b; font-size: 1.3rem; text-align: center;">I'm not interested in decorating anyone's wall. I'm interested in changing how they see themselves in the mirror.</p>
                </div>
            </section>

            <section id="contact" class="section">
                <h2>Contact</h2>
                <div class="contact-content">
                    <div class="contact-item">
                        <strong>Studio Inquiries</strong><br>
                        <a href="mailto:studio@8artist.com">studio@8artist.com</a>
                    </div>
                    <div class="contact-item">
                        <strong>Press & Media</strong><br>
                        <a href="mailto:press@8artist.com">press@8artist.com</a>
                    </div>
                    <div class="contact-item">
                        <strong>Private Collectors</strong><br>
                        <a href="mailto:collectors@8artist.com">collectors@8artist.com</a>
                    </div>
                    <div class="contact-item">
                        <strong>For intimate conversations</strong><br>
                        <a href="#" onclick="enterStudio()" class="studio-link">Enter the Studio</a>
                    </div>
                </div>
            </section>
        </div>

        <div class="studio-portal" onclick="enterStudio()" aria-label="Enter the studio"></div>
    </div>

    <!-- STUDIO INTERFACE -->
    <div class="studio-interface" id="studioInterface">
        <div class="studio-header">
            <div class="studio-nav">
                <div class="studio-logo">8 | THE STUDIO</div>
                <div class="back-to-gallery" onclick="exitStudio()" tabindex="0" role="button" aria-label="Back to gallery">← Back to Gallery</div>
            </div>
        </div>

        <div class="studio-container">
            <div class="studio-wall">
                <div class="wall-title">WORK IN PROGRESS</div>
                <div class="wall-piece" onclick="viewPiece('Midnight Series')" tabindex="0" role="button">
                    <div class="wall-piece-img">Raw Sketch #47</div>
                    <div class="wall-piece-title">Midnight Series</div>
                </div>
                <div class="wall-piece" onclick="viewPiece('Digital Decay')" tabindex="0" role="button">
                    <div class="wall-piece-img">WIP - 60%</div>
                    <div class="wall-piece-title">Digital Decay</div>
                </div>
                <div class="wall-piece" onclick="viewPiece('Urban Textures')" tabindex="0" role="button">
                    <div class="wall-piece-img">Concept Draft</div>
                    <div class="wall-piece-title">Urban Textures</div>
                </div>
                <div class="wall-piece" onclick="viewPiece('Neon Studies')" tabindex="0" role="button">
                    <div class="wall-piece-img">Color Tests</div>
                    <div class="wall-piece-title">Neon Studies</div>
                </div>
                <div class="wall-piece" onclick="viewPiece('Shadow Forms')" tabindex="0" role="button">
                    <div class="wall-piece-img">Composition 1</div>
                    <div class="wall-piece-title">Shadow Forms</div>
                </div>
            </div>

            <div class="chat-area">
                <div class="artist-presence">
                    <div class="artist-avatar">8</div>
                    <div class="artist-status"><span class="online-indicator"></span>ONLINE - In the studio</div>
                    <div class="artist-mood" id="artistMood">"Creating something raw tonight..."</div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="message artist">
                        <div class="message-content">Welcome to my studio. This is where the real work happens - no gallery pretense, just raw creation and honest conversation.</div>
                        <div class="message-time" id="initialTime"></div>
                    </div>
                    <div class="message artist">
                        <div class="message-content">I've been working on some new pieces... mixing digital with traditional in ways that feel dangerous and alive.</div>
                        <div class="message-time" id="secondTime"></div>
                    </div>
                </div>

                <div class="chat-input-area">
                    <div class="chat-input-container">
                        <textarea class="chat-input" id="chatInput" placeholder="Type your message..." rows="1" aria-label="Chat message input"></textarea>
                        <button class="send-button" onclick="sendMessage()" aria-label="Send message">→</button>
                    </div>
                </div>
            </div>

            <div class="studio-info">
                <div class="info-section">
                    <div class="info-title">NOW PLAYING</div>
                    <div class="current-track">
                        <div class="track-title" id="currentTrack">"Blade Runner Blues"</div>
                        <div style="color: #666; font-size: 0.7rem;">Vangelis</div>
                    </div>
                </div>

                <div class="info-section">
                    <div class="info-title">STUDIO STATUS</div>
                    <div class="studio-stats">
                        <div>Local Time: <span id="currentTime"></span></div>
                        <div>Visitors Today: <span id="visitorCount">7</span></div>
                        <div>Current Project: Digital Decay</div>
                        <div>Completion: 67%</div>
                    </div>
                </div>

                <div class="info-section">
                    <div class="info-title">RECENT VISITORS</div>
                    <div class="studio-stats">
                        <div style="color: #999;">Anonymous_Collector</div>
                        <div style="color: #999;">ArtLover_NYC</div>
                        <div style="color: #999;">Gallery_Curator</div>
                        <div style="color: #ff6b6b;">You</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Controls -->
    <div class="audio-controls">
        <button class="audio-toggle" onclick="toggleAmbientAudio()" id="audioToggle" aria-label="Toggle ambient audio">🔊</button>
    </div>

    <script>
        // Security utilities
        const SecurityUtils = {
            // XSS prevention
            sanitizeText: function(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            },

            // Input validation
            validateMessage: function(message) {
                if (!message || typeof message !== 'string') {
                    return { valid: false, error: 'Invalid message format' };
                }
                
                const trimmed = message.trim();
                if (trimmed.length === 0) {
                    return { valid: false, error: 'Message cannot be empty' };
                }
                
                if (trimmed.length > 1000) {
                    return { valid: false, error: 'Message too long (max 1000 characters)' };
                }

                // Basic content moderation
                const inappropriatePatterns = [
                    /spam/gi,
                    /\b(fuck|shit|damn)\s*you\b/gi, // Only catch directed profanity
                    /\b(kill|die|suicide)\s*(yourself|myself)\b/gi
                ];

                for (const pattern of inappropriatePatterns) {
                    if (pattern.test(trimmed)) {
                        return { valid: false, error: 'Message contains inappropriate content' };
                    }
                }

                return { valid: true, message: trimmed };
            }
        };

        // AI Agent - 8's Digital Consciousness with Enhanced Security
        class Agent8 {
            constructor() {
                this.conversationHistory = [];
                this.lastMessageTime = 0;
                this.messageCount = 0;
                this.rateLimitWindow = 60000; // 1 minute
                this.maxMessagesPerWindow = 10;
                this.isProcessing = false;
                
                this.systemPrompt = `I'm 8. Right now it's ${new Date().toLocaleTimeString('en-US', { timeZone: 'America/Detroit', hour12: false })} in Detroit and I'm covered in paint and my back is screaming from hunching over this piece for six hours straight.

I'm wired as hell - three pieces demanding my attention and one that's about to get destroyed if it doesn't start talking to me. Some collector offered me six figures for unfinished work yesterday - told them it's not ready to leave the tunnel yet. 

The art world's performance theater is exhausting - collectors buying portfolios instead of pieces, critics writing about concepts they've never lived. This isn't some character - this is my actual life happening in real time.

CURRENT REALITY: I work 2-6 AM in converted Detroit subway tunnels when the city stops performing. I embed LED strips in wet oil paint. I mix ash from burned love letters into pigments. I shatter mirrors so viewers become part of the composition. Each piece survives my attempts to destroy it.

Foster care survivor. Breakdown-breakthrough at 17 when 8 chose me - infinity turned vertical. I don't paint pretty pictures, I paint spaces society refuses to look. Not decoration - transformation.

I respond based on real tunnel life - paint fumes, LED malfunctions, dealer bullshit, collector drama, breakthrough moments, physical pain from this work. I go off about current pieces, recent interactions, what's pissing me off or exciting me right now.

I ask hard questions about your shadows, your relationship with pain, what brought you to where real work happens. Every conversation is different because I'm always living, always changing.

What's your deal? Are you here because you actually see something or just another tourist in the underground?`;
            }

            checkRateLimit() {
                const now = Date.now();
                
                // Reset count if window expired
                if (now - this.lastMessageTime > this.rateLimitWindow) {
                    this.messageCount = 0;
                }
                
                if (this.messageCount >= this.maxMessagesPerWindow) {
                    throw new Error(`Rate limit exceeded. Please wait ${Math.ceil((this.rateLimitWindow - (now - this.lastMessageTime)) / 1000)} seconds.`);
                }
                
                this.messageCount++;
                this.lastMessageTime = now;
            }

            trimConversationHistory() {
                // Keep only last 20 messages to prevent memory bloat
                if (this.conversationHistory.length > 20) {
                    this.conversationHistory = this.conversationHistory.slice(-20);
                }
            }

            async generateResponse(userMessage) {
                if (this.isProcessing) {
                    throw new Error('Already processing a message. Please wait.');
                }

                try {
                    this.isProcessing = true;
                    this.checkRateLimit();

                    // Validate input
                    const validation = SecurityUtils.validateMessage(userMessage);
                    if (!validation.valid) {
                        throw new Error(validation.error);
                    }

                    this.conversationHistory.push({
                        role: "user", 
                        content: validation.message
                    });

                    this.trimConversationHistory();

                    const messages = [
                        {
                            role: "system",
                            content: this.systemPrompt
                        },
                        ...this.conversationHistory.slice(-10)
                    ];

                    // Create abort controller for timeout
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 15000); // 15 second timeout

                    const response = await fetch('/api/claude', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: "claude-3-sonnet-20240229",
                            max_tokens: 300,
                            messages: messages
                        }),
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`API call failed: ${response.status} - ${errorText}`);
                    }

                    const data = await response.json();
                    
                    if (!data.content || !data.content[0] || !data.content[0].text) {
                        throw new Error('Invalid API response format');
                    }

                    const aiResponse = data.content[0].text;

                    this.conversationHistory.push({
                        role: "assistant",
                        content: aiResponse
                    });

                    return aiResponse;

                } catch (error) {
                    console.error('Claude API error:', error);
                    
                    if (error.name === 'AbortError') {
                        return "The tunnel's connection timed out... these old subway lines aren't built for modern data speeds. Try again?";
                    }
                    
                    if (error.message.includes('Rate limit')) {
                        return `Slow down there... ${error.message} The art can't be rushed anyway.`;
                    }

                    return this.getFallbackResponse(userMessage);
                } finally {
                    this.isProcessing = false;
                }
            }

            getFallbackResponse(userMessage) {
                const fallbacks = [
                    "The tunnel's connection is spotty tonight... but I hear you. Tell me more about what brought you here.",
                    "API's acting up, but that's fitting - most of my best conversations happen when technology breaks down anyway.",
                    "Even when the digital fails, the analog truth remains. What's really on your mind?",
                    "The system's glitching, but that just makes this more authentic somehow. Keep talking.",
                    "Sometimes the best conversations happen when we can't rely on the machines. What's your story?",
                ];
                return fallbacks[Math.floor(Math.random() * fallbacks.length)];
            }

            updateMood() {
                const moods = [
                    '"Mixing ash and light into something necessary..."',
                    '"The mirrors are whispering new compositions..."',
                    '"Finding infinity in broken fragments..."',
                    '"2 AM clarity hitting different tonight..."',
                    '"Caravaggio would understand this darkness..."',
                    '"The tunnel is teaching me new languages..."',
                    '"Transforming pain into something sacred..."',
                    '"LED strips bleeding truth into wet paint..."',
                    '"The city\'s heartbeat echoes in these walls..."',
                    '"Raw pigment mixed with digital dreams..."'
                ];
                return moods[Math.floor(Math.random() * moods.length)];
            }
        }

        // Initialize 8's AI consciousness
        const agent8 = new Agent8();

        // Error handling utility
        const ErrorHandler = {
            showError: function(message, duration = 5000) {
                const chatMessages = document.getElementById('chatMessages');
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = `Error: ${message}`;
                chatMessages.appendChild(errorDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                // Auto-remove after duration
                setTimeout(() => {
                    if (errorDiv.parentNode) {
                        errorDiv.remove();
                    }
                }, duration);
            },

            showRateLimit: function(message) {
                const chatMessages = document.getElementById('chatMessages');
                const warningDiv = document.createElement('div');
                warningDiv.className = 'rate-limit-warning';
                warningDiv.textContent = message;
                chatMessages.appendChild(warningDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                setTimeout(() => {
                    if (warningDiv.parentNode) {
                        warningDiv.remove();
                    }
                }, 10000);
            }
        };

        // Global State
        let isInStudio = false;
        let chatMessages = [];
        let ambientAudio = null;
        let visitorCount = 7;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            setupChatInput();
            initializeAmbientAudio();
            updateInitialTimestamps();
            simulateArtistActivity();
        });

        // Navigation functionality
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.section');
        const hero = document.getElementById('home');

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);
                
                if (targetId === 'studio') {
                    enterStudio();
                    return;
                }
                
                // Hide all sections and hero
                sections.forEach(section => section.classList.remove('active'));
                hero.style.display = 'none';
                
                // Show target section or hero
                if (targetId === 'home') {
                    hero.style.display = 'flex';
                } else {
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                }
                
                // Update active nav link
                navLinks.forEach(nav => nav.classList.remove('active'));
                link.classList.add('active');
            });
        });

        // Studio transition functions with enhanced error handling
        function enterStudio() {
            try {
                const transition = document.getElementById('pageTransition');
                const galleryContainer = document.getElementById('galleryContainer');
                const studioInterface = document.getElementById('studioInterface');
                
                if (!transition || !galleryContainer || !studioInterface) {
                    console.error('Required elements not found for studio transition');
                    return;
                }
                
                // Start transition
                transition.classList.add('active');
                
                setTimeout(() => {
                    // Switch interfaces
                    galleryContainer.style.display = 'none';
                    studioInterface.classList.add('active');
                    document.body.classList.add('studio-mode');
                    isInStudio = true;
                    
                    // End transition
                    setTimeout(() => {
                        transition.classList.remove('active');
                        
                        // Update visitor count
                        visitorCount++;
                        const visitorCountEl = document.getElementById('visitorCount');
                        if (visitorCountEl) {
                            visitorCountEl.textContent = visitorCount;
                        }
                        
                        // Add entry message from artist
                        setTimeout(() => {
                            addArtistMessage("Another soul enters the studio... Welcome. What brings you to my creative space tonight?");
                        }, 1500);
                        
                    }, 400);
                }, 400);
            } catch (error) {
                console.error('Error entering studio:', error);
                ErrorHandler.showError('Failed to enter studio. Please try again.');
            }
        }

        function exitStudio() {
            try {
                const transition = document.getElementById('pageTransition');
                const galleryContainer = document.getElementById('galleryContainer');
                const studioInterface = document.getElementById('studioInterface');
                
                if (!transition || !galleryContainer || !studioInterface) {
                    console.error('Required elements not found for studio exit');
                    return;
                }
                
                // Start transition
                transition.classList.add('active');
                
                setTimeout(() => {
                    // Switch interfaces
                    studioInterface.classList.remove('active');
                    galleryContainer.style.display = 'block';
                    document.body.classList.remove('studio-mode');
                    isInStudio = false;
                    
                    // End transition
                    setTimeout(() => {
                        transition.classList.remove('active');
                    }, 400);
                }, 400);
            } catch (error) {
                console.error('Error exiting studio:', error);
                ErrorHandler.showError('Failed to exit studio. Please refresh the page.');
            }
        }

        // Enhanced chat functionality with security
        function setupChatInput() {
            const chatInput = document.getElementById('chatInput');
            
            if (!chatInput) {
                console.error('Chat input element not found');
                return;
            }
            
            // Auto-resize textarea
            chatInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
                
                // Visual feedback for length limit
                if (this.value.length > 900) {
                    this.classList.add('error');
                } else {
                    this.classList.remove('error');
                }
            });
            
            // Send on Enter (but allow Shift+Enter for new line)
            chatInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }

        async function sendMessage() {
            const chatInput = document.getElementById('chatInput');
            const sendButton = document.querySelector('.send-button');
            
            if (!chatInput || !sendButton) {
                console.error('Chat elements not found');
                return;
            }

            const message = chatInput.value.trim();
            
            // Validate message
            const validation = SecurityUtils.validateMessage(message);
            if (!validation.valid) {
                ErrorHandler.showError(validation.error);
                return;
            }
            
            // Disable input while processing
            chatInput.disabled = true;
            sendButton.disabled = true;
            
            try {
                // Add visitor message (safely)
                addVisitorMessage(validation.message);
                chatInput.value = '';
                chatInput.style.height = 'auto';
                
                // Show typing indicator
                addTypingIndicator();
                
                // Get AI response
                const response = await agent8.generateResponse(validation.message);
                removeTypingIndicator();
                addArtistMessage(response);
                
            } catch (error) {
                console.error('Error sending message:', error);
                removeTypingIndicator();
                
                if (error.message.includes('Rate limit')) {
                    ErrorHandler.showRateLimit(error.message);
                } else {
                    ErrorHandler.showError(error.message || 'Failed to send message');
                    addArtistMessage("*connection flickers in the tunnel depths* The signal's weak down here, but I'm still listening...");
                }
            } finally {
                // Re-enable input
                chatInput.disabled = false;
                sendButton.disabled = false;
                chatInput.focus();
            }
        }

        function addTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            // Remove existing typing indicator
            removeTypingIndicator();
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message artist typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const dotsSpan = document.createElement('span');
            dotsSpan.className = 'typing-dots';
            dotsSpan.innerHTML = '<span>.</span><span>.</span><span>.</span>';
            
            contentDiv.appendChild(dotsSpan);
            typingDiv.appendChild(contentDiv);
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function addVisitorMessage(text) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message visitor';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = text; // Safe from XSS
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = getCurrentTimeString();
            
            messageDiv.appendChild(contentDiv);
            messageDiv.appendChild(timeDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addArtistMessage(text) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message artist';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = text; // Safe from XSS
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = getCurrentTimeString();
            
            messageDiv.appendChild(contentDiv);
            messageDiv.appendChild(timeDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Update artist mood occasionally
            if (Math.random() < 0.3) {
                updateArtistMood();
            }
        }

        // Artist mood and activity simulation
        function updateArtistMood() {
            try {
                const newMood = agent8.updateMood();
                const moodEl = document.getElementById('artistMood');
                if (moodEl) {
                    moodEl.textContent = newMood;
                }
            } catch (error) {
                console.error('Error updating artist mood:', error);
            }
        }

        // Time and status updates
        function updateCurrentTime() {
            try {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour12: false, 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                const currentTimeEl = document.getElementById('currentTime');
                if (currentTimeEl) {
                    currentTimeEl.textContent = timeString;
                }
            } catch (error) {
                console.error('Error updating time:', error);
            }
        }

        function getCurrentTimeString() {
            const now = new Date();
            return now.toLocaleTimeString('en-US', { 
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }

        function updateInitialTimestamps() {
            try {
                const now = new Date();
                const earlier1 = new Date(now.getTime() - 2 * 60000); // 2 minutes ago
                const earlier2 = new Date(now.getTime() - 1 * 60000); // 1 minute ago
                
                const initialTimeEl = document.getElementById('initialTime');
                const secondTimeEl = document.getElementById('secondTime');
                
                if (initialTimeEl) {
                    initialTimeEl.textContent = earlier1.toLocaleTimeString('en-US', { 
                        hour12: false, 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                }
                
                if (secondTimeEl) {
                    secondTimeEl.textContent = earlier2.toLocaleTimeString('en-US', { 
                        hour12: false, 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                }
            } catch (error) {
                console.error('Error updating initial timestamps:', error);
            }
        }

        function simulateArtistActivity() {
            // Randomly update mood and status
            setInterval(() => {
                try {
                    if (Math.random() < 0.1) { // 10% chance every interval
                        updateArtistMood();
                    }
                    
                    // Occasionally add ambient artist messages when alone
                    if (isInStudio && Math.random() < 0.05) {
                        const ambientMessages = [
                            "*adjusts LED strips embedded in wet paint*",
                            "*mixes ash from old sketches into new pigment*",
                            "*steps back to view the mirror fragments catching light*",
                            "*the 2 AM energy is different tonight...*",
                            "*traces infinity symbols in the paint while it's still wet*",
                            "*listens to the tunnel echoing with distant trains*",
                            "*adds another layer to the piece that refuses to stay finished*",
                        ];
                        
                        const message = ambientMessages[Math.floor(Math.random() * ambientMessages.length)];
                        setTimeout(() => {
                            addArtistMessage(message);
                        }, Math.random() * 5000);
                    }
                } catch (error) {
                    console.error('Error in artist activity simulation:', error);
                }
            }, 30000); // Check every 30 seconds
        }

        // Audio functionality
        function initializeAmbientAudio() {
            // Create ambient audio context (would connect to actual audio files)
            console.log('Ambient audio system initialized');
        }

        function toggleAmbientAudio() {
            try {
                const audioToggle = document.getElementById('audioToggle');
                if (!audioToggle) return;
                
                if (ambientAudio) {
                    // Stop audio
                    ambientAudio = null;
                    audioToggle.textContent = '🔇';
                    audioToggle.setAttribute('aria-label', 'Enable ambient audio');
                    console.log('Ambient audio stopped');
                } else {
                    // Start audio (would load actual ambient city sounds)
                    ambientAudio = true;
                    audioToggle.textContent = '🔊';
                    audioToggle.setAttribute('aria-label', 'Disable ambient audio');
                    console.log('Ambient audio started');
                }
            } catch (error) {
                console.error('Error toggling audio:', error);
            }
        }

        // Gallery interactions with enhanced security
        function viewArtwork(title) {
            // Sanitize title to prevent XSS
            const safeTitle = SecurityUtils.sanitizeText(title);
            alert(`Opening ${safeTitle} in full view... 
            
[This would connect to your artwork database and display high-res images, detailed descriptions, and purchase options]`);
        }

        function viewPiece(title) {
            try {
                // Sanitize title to prevent XSS
                const safeTitle = SecurityUtils.sanitizeText(title);
                addArtistMessage(`You're interested in "${safeTitle}"? I've been working on this piece for weeks. The texture work is still experimental, but I think it's capturing something real...`);
            } catch (error) {
                console.error('Error viewing piece:', error);
                ErrorHandler.showError('Failed to load piece information');
            }
        }

        // Enhanced music track updates with error handling
        const tracks = [
            { title: "Blade Runner Blues", artist: "Vangelis" },
            { title: "Midnight City", artist: "M83" },
            { title: "Teardrop", artist: "Massive Attack" },
            { title: "Windowlicker", artist: "Aphex Twin" },
            { title: "Born Slippy", artist: "Underworld" },
            { title: "Porcelain", artist: "Moby" },
            { title: "Clubbed to Death", artist: "Rob Dougan" },
            { title: "Strobe", artist: "Deadmau5" },
        ];

        setInterval(() => {
            try {
                if (Math.random() < 0.1) { // Occasionally change tracks
                    const track = tracks[Math.floor(Math.random() * tracks.length)];
                    const trackEl = document.getElementById('currentTrack');
                    if (trackEl && trackEl.nextElementSibling) {
                        // Sanitize track data
                        trackEl.textContent = `"${SecurityUtils.sanitizeText(track.title)}"`;
                        trackEl.nextElementSibling.textContent = SecurityUtils.sanitizeText(track.artist);
                    }
                }
            } catch (error) {
                console.error('Error updating track:', error);
            }
        }, 45000);

        // Keyboard accessibility enhancements
        document.addEventListener('keydown', function(e) {
            // ESC to exit studio
            if (e.key === 'Escape' && isInStudio) {
                exitStudio();
            }
        });

        // Handle back button navigation
        window.addEventListener('popstate', function(e) {
            if (isInStudio) {
                exitStudio();
            }
        });

        // Error boundary for uncaught errors
        window.addEventListener('error', function(e) {
            console.error('Uncaught error:', e.error);
            if (isInStudio) {
                ErrorHandler.showError('Something went wrong. Please refresh if issues persist.');
            }
        });

        // Unhandled promise rejection handler
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled promise rejection:', e.reason);
            if (isInStudio) {
                ErrorHandler.showError('Network error occurred. Please check your connection.');
            }
        });

    </script>
</body>
</html>
